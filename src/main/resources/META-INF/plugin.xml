<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.github.mr3zee.kotlinPlugins</id>
    <name>Kotlin External FIR Support</name>
    <description>
        Provides support for external FIR based Kotlin compiler plugins.
    </description>
    <vendor>Mr3zee</vendor>
    <category>Kotlin</category>

    <depends>org.jetbrains.kotlin</depends>
    <depends>com.intellij.modules.platform</depends>

    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <!--suppress PluginXmlValidity -->
        <bundledFirCompilerPluginProvider implementation="com.github.mr3zee.kotlinPlugins.KotlinPluginsProvider"/>
        <supportsKotlinPluginMode supportsK1="false" supportsK2="true"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <postStartupActivity
                implementation="com.github.mr3zee.kotlinPlugins.ExternalSystemReloadBridgeActivity"/>

        <projectConfigurable
                id="com.github.mr3zee.kotlinPlugins.settings"
                parentId="tools"
                displayName="Kotlin Plugins"
                instance="com.github.mr3zee.kotlinPlugins.KotlinPluginsConfigurable"
                nonDefaultProject="false"
        />

        <toolWindow
                id="Kotlin Plugins Diagnostics"
                anchor="bottom"
                icon="/icons/tool_window.svg"
                factoryClass="com.github.mr3zee.kotlinPlugins.KotlinPluginsToolWindowFactory"
        />

        <projectService
                serviceInterface="com.github.mr3zee.kotlinPlugins.KotlinPluginsExceptionReporter"
                serviceImplementation="com.github.mr3zee.kotlinPlugins.KotlinPluginsExceptionReporterImpl"
        />

        <editorNotificationProvider
                implementation="com.github.mr3zee.kotlinPlugins.KotlinPluginsEditorNotificationProvider"
        />

        <notificationGroup id="Kotlin External FIR Support"
                           displayType="BALLOON"
                           key="notification.kotlin.external.fir.support"/>

        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-core"
                           displayName="kotlinx-rpc"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-compiler-plugin-backend"
                           displayName="kotlinx-rpc: Compiler Plugin Backend"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-compiler-plugin-k2"
                           displayName="kotlinx-rpc: Compiler Plugin K2"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-compiler-plugin-cli"
                           displayName="kotlinx-rpc: Compiler Plugin CLI"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-compiler-plugin-common"
                           displayName="kotlinx-rpc: Compiler Plugin Common"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-krpc-core"
                           displayName="kotlinx-rpc: kRPC Core"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-krpc-client"
                           displayName="kotlinx-rpc: kRPC Client"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-krpc-server"
                           displayName="kotlinx-rpc: kRPC Server"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-krpc-ktor-core"
                           displayName="kotlinx-rpc: kRPC Ktor Core"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-krpc-ktor-client"
                           displayName="kotlinx-rpc: kRPC Ktor Client"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-krpc-ktor-server"
                           displayName="kotlinx-rpc: kRPC Ktor Server"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-grpc-core"
                           displayName="kotlinx-rpc: gRPC Core"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-grpc-client"
                           displayName="kotlinx-rpc: gRPC Client"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-grpc-server"
                           displayName="kotlinx-rpc: gRPC Server"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-grpc-ktor-server"
                           displayName="kotlinx-rpc: gRPC Ktor Server"/>
        <dependencySupport kind="java" coordinate="org.jetbrains.kotlinx:kotlinx-rpc-protobuf-core"
                           displayName="kotlinx-rpc: Protobuf Core"/>

        <!--    TODO contact marketplace@jetbrains.com-->
        <errorHandler implementation="com.intellij.diagnostic.JetBrainsMarketplaceErrorReportSubmitter"/>

    </extensions>

    <actions>
        <action
                id="com.github.mr3zee.kotlinPlugins.KotlinPluginsClearCachesAction"
                class="com.github.mr3zee.kotlinPlugins.KotlinPluginsClearCachesAction"
                text="Kotlin FIR External Support: Clear Caches"
                description="Allows to clear the caches for Kotlin compiler plugins for this IDE">
        </action>
        <action
                id="com.github.mr3zee.kotlinPlugins.KotlinPluginsRefreshAction"
                class="com.github.mr3zee.kotlinPlugins.KotlinPluginsRefreshAction"
                text="Kotlin FIR External Support: Refresh Plugins"
                description="Allows to refresh the Kotlin compiler plugins state without clearing caches">
        </action>
        <action
                id="com.github.mr3zee.kotlinPlugins.KotlinPluginsUpdateAction"
                class="com.github.mr3zee.kotlinPlugins.KotlinPluginsUpdateAction"
                text="Kotlin FIR External Support: Update Plugins"
                description="Allows to update the Kotlin compiler plugins data with the newest versions">
        </action>
    </actions>
</idea-plugin>
